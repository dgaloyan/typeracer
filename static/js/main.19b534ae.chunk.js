(this.webpackJsonptyperacer=this.webpackJsonptyperacer||[]).push([[0],{21:function(e,t,n){},34:function(e,t,n){e.exports=n(64)},57:function(e,t,n){},58:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(31),s=n.n(c),u=(n(21),n(2)),i=n(16),o=n.n(i),l=n(13),f=n(7),h=n(1),p=n.n(h),m=n(5),b=function(e){var t=Math.floor(e/1e3),n=Math.floor(t/60/60),r=Math.floor(t/60)-60*n,a=t%60;return("0"+n).substr(-2)+":"+("0"+r).substr(-2)+":"+("0"+a).substr(-2)},g=(n(57),function(e){var t=e.time,n=e.onFinish,c=e.start,s=e.finished,i=Object(r.useState)(b(t)),o=Object(u.a)(i,2),l=o[0],f=o[1],h=Object(r.useRef)(0),p=Object(r.useRef)(t),m=Object(r.useCallback)((function(){h.current=setInterval((function(){p.current-=1e3,f(b(p.current)),0===p.current&&(clearInterval(h.current),f(b(p.current)),n(p.current))}),1e3)}),[s]);return Object(r.useEffect)((function(){f(b(t))}),[c,t]),Object(r.useEffect)((function(){s&&(clearInterval(h.current),n(p.current),p.current=t)}),[s]),Object(r.useEffect)((function(){c&&!s&&m()}),[c,s,m]),a.a.createElement("div",{className:"timer"},a.a.createElement("span",null,l))}),v=(n(58),Object(r.createContext)({})),d=function(e){return function(t){return a.a.createElement(e,Object.assign({},t,Object(r.useContext)(v)))}},y=function(e){var t=e.children,n=e.color;return a.a.createElement("span",{className:"text"+n},t)},j=d((function(e){var t=e.text,n=e.progress,c=Object(r.useState)(t),s=Object(u.a)(c,2),i=s[0],o=s[1];return Object(r.useEffect)((function(){o(function(e,t,n,r){return n<=0?e:a.a.createElement(a.a.Fragment,null,e.substring(0,t),a.a.createElement(y,{color:r},e.substring(t,n)),e.substring(n))}(t,0,n,"Match"))}),[t,n]),a.a.createElement("div",{style:{userSelect:"none"}},i)})),O=function(e){var t=e.text,n=e.onChange,r=e.disabled;return a.a.createElement("textarea",{disabled:r,onChange:n,value:t,onPaste:function(e){return e.preventDefault()}})},E=function(e){var t=e.loading,n=e.children;return t?a.a.createElement("div",{style:{margin:"0 auto",fontSize:32}},"Loading ..."):n},k=function(e){var t=e.stats;return a.a.createElement("div",{className:"stats"},t.length>0&&a.a.createElement(a.a.Fragment,null,t.map((function(e){return a.a.createElement("div",{key:e},e)})),a.a.createElement("p",null,"You can see your stats by navigating to ",a.a.createElement("a",{href:"/stats"},"stats"))))},x=d((function(e){var t=e.appContainer,n=Object(r.useState)(),c=Object(u.a)(n,2),s=c[0],i=c[1],o=Object(r.useState)(!0),l=Object(u.a)(o,2),f=l[0],h=l[1],b=Object(r.useState)(!1),v=Object(u.a)(b,2),d=v[0],y=v[1],x=Object(r.useState)(!1),w=Object(u.a)(x,2),C=w[0],S=w[1],R=Object(r.useState)(""),I=Object(u.a)(R,2),L=I[0],T=I[1],F=Object(r.useState)(0),N=Object(u.a)(F,2),P=N[0],M=N[1],U=Object(r.useState)(""),A=Object(u.a)(U,2),B=A[0],J=A[1],W=Object(r.useState)(""),D=Object(u.a)(W,2),Y=D[0],z=D[1],$=Object(r.useState)([]),q=Object(u.a)($,2),G=q[0],H=q[1],K=Object(r.useState)(null),Q=Object(u.a)(K,2),V=Q[0],X=Q[1],Z=Object(r.useState)(!1),_=Object(u.a)(Z,2),ee=_[0],te=_[1],ne=Object(r.useCallback)(t.getMatchingStrategyFactory(),[]),re=Object(r.useCallback)(t.getTimeToComplete(),[V]);Object(r.useEffect)((function(){Promise.resolve().then(Object(m.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTextProvider().getText();case 2:n=e.sent,T(n),h(!1),i(ne.create(n));case 6:case"end":return e.stop()}}),e)}))))}),[t,ne]),Object(r.useEffect)((function(){if(s){var e=s.check(Y);J(Y.substring(e,Y.length)),M(e),e===L.length&&te(!0)}}),[Y,s,L.length]);var ae=function(){var e=Object(m.a)(p.a.mark((function e(){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),n=t.getAnalysers(),r=[],a=0===V?re:V,n.forEach((function(e){r.push(e.analyse(L,P,Y,a))})),e.next=7,t.getStatsRepository().save(r);case 7:H([].concat(r)),h(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){null!==V&&ae().then((function(e){}))}),[V]);var ce=function(){var e=Object(m.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,t.textProvider.getText();case 3:n=e.sent,T(n),i(ne.create(n)),y(!1),S(!1),M(0),J(""),z(""),H([]),X(null),te(!1),h(!1);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"board"},"Welcome to TypeRacer",a.a.createElement(k,{stats:G}),G.length>0&&a.a.createElement("button",{onClick:ce},"Play again"),a.a.createElement(g,{time:re,start:d,finished:ee,onFinish:function(e){S(!0),X(re-e)}}),a.a.createElement(E,{loading:f},a.a.createElement("div",{style:{opacity:B?1:0},className:"textError"},B),a.a.createElement("div",{className:"texts"},a.a.createElement(j,{text:L,progress:P}),a.a.createElement(O,{text:Y,onChange:function(e){d||y(!0),z(e.target.value)},disabled:C}))))})),w=n(4),C=n(6),S=function(){function e(t){Object(w.a)(this,e),this.httpClient=t}return Object(C.a)(e,[{key:"getText",value:function(){var e=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("https://baconipsum.com/api/?type=meat-and-filler?paras=2");case 2:return t=e.sent,e.abrupt("return",t.data.join(""));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),R=function(){function e(t,n,r,a,c,s){Object(w.a)(this,e),this.textProvider=t,this.matchingStrategyFactory=n,this.analysers=r,this.statsRepository=a,this.userRepository=c,this.timeToComplete=s}return Object(C.a)(e,[{key:"getTextProvider",value:function(){return this.textProvider}},{key:"getMatchingStrategyFactory",value:function(){return this.matchingStrategyFactory}},{key:"getAnalysers",value:function(){return this.analysers}},{key:"getStatsRepository",value:function(){return this.statsRepository}},{key:"getUserRepository",value:function(){return this.userRepository}},{key:"getTimeToComplete",value:function(){return this.timeToComplete}}]),e}(),I=function(){function e(){Object(w.a)(this,e)}return Object(C.a)(e,[{key:"analyse",value:function(e,t,n,r){return"The completeness's percentage is  "+((t/e.length*100).toFixed(1)+"%")}}]),e}(),L=function(){function e(){Object(w.a)(this,e)}return Object(C.a)(e,[{key:"analyse",value:function(e,t,n,r){var a=(t/5/(r/1e3/60)).toFixed(1);return"Your WPM is ".concat(a)}}]),e}(),T=function(){function e(t){Object(w.a)(this,e),this.text=t,this.check=this.check.bind(this)}return Object(C.a)(e,[{key:"check",value:function(e){if(0===e.length)return 0;for(var t=0;t<e.length&&this.text.charAt(t)===e.charAt(t);)t++;return t}}]),e}(),F=function(){function e(){Object(w.a)(this,e)}return Object(C.a)(e,[{key:"create",value:function(e){return new T(e)}}]),e}(),N=n(15),P=function e(t,n){Object(w.a)(this,e),this.data=t,this.error=n},M=function(){function e(t,n){Object(w.a)(this,e),this.httpClient=t,this.userRepository=n}return Object(C.a)(e,[{key:"save",value:function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,a,c=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("https://api.myjson.com/bins/sk100");case 2:return n=e.sent,(r=n.data.find((function(e){return e.username===c.userRepository.get().username}))).stats||(r.stats=[]),r.stats.push([].concat(Object(N.a)(t),[new Date])),e.next=8,this.httpClient.put("https://api.myjson.com/bins/sk100",n.data);case 8:return a=e.sent,e.abrupt("return",new P(a.data,null));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("https://api.myjson.com/bins/sk100");case 2:return t=e.sent,e.abrupt("return",new P(t.data,null));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),U=function(){function e(t){Object(w.a)(this,e),this.subscribers=[],this.isLoggedIn=!!localStorage.getItem("user"),this.httpClient=t}return Object(C.a)(e,[{key:"login",value:function(){var e=Object(m.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("https://api.myjson.com/bins/sk100");case 2:if(!e.sent.data.find((function(e){return e.username===t}))){e.next=8;break}return this.isLoggedIn=!0,localStorage.setItem("user",JSON.stringify({username:t})),this.notify("loginChange",this.isLoggedIn),e.abrupt("return",new P({},null));case 8:return e.abrupt("return",new P(null,"username ".concat(t," is not correct")));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("https://api.myjson.com/bins/sk100");case 2:if(!(n=e.sent).data.find((function(e){return e.username===t}))){e.next=5;break}return e.abrupt("return",new P(null,"username ".concat(t," already exists")));case 5:return e.next=7,this.httpClient.put("https://api.myjson.com/bins/sk100",[].concat(Object(N.a)(n.data),[{username:t}]));case 7:return r=e.sent,e.abrupt("return",new P(r.data,null));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){localStorage.removeItem("user"),this.isLoggedIn=!1,this.notify("loginChange",this.isLoggedIn)}},{key:"get",value:function(){return JSON.parse(localStorage.getItem("user"))}},{key:"notify",value:function(e,t){this.subscribers[e]&&this.subscribers[e].forEach((function(e){e(t)}))}},{key:"subscribe",value:function(e,t){var n=this;return this.subscribers[e]||(this.subscribers[e]=new Map),this.subscribers[e].set(t.toString(),t),function(){return n.subscribers[e].delete(t.toString())}}}]),e}(),A=d((function(e){var t=e.appContainer,n=Object(r.useState)(null),c=Object(u.a)(n,2),s=c[0],i=c[1],o=Object(r.useState)(null),l=Object(u.a)(o,2),h=l[0],b=l[1],g=Object(f.g)(),v=function(){var e=Object(m.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.getUserRepository().register(s);case 4:if(!(n=e.sent).error){e.next=8;break}return b(n.error),e.abrupt("return");case 8:g.push("/login");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"auth"},a.a.createElement("input",{type:"text",onChange:function(e){i(e.target.value)},placeholder:"type your username"}),a.a.createElement("button",{onClick:v},"Register"),a.a.createElement("a",{href:"/login"}," or Login"),h&&a.a.createElement("div",{style:{color:"red"}},h))})),B=d((function(e){var t=e.appContainer,n=Object(r.useState)(null),c=Object(u.a)(n,2),s=c[0],i=c[1],o=Object(r.useState)(null),l=Object(u.a)(o,2),f=l[0],h=l[1],b=function(){var e=Object(m.a)(p.a.mark((function e(){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return n=t.getUserRepository(),e.next=5,n.login(s);case 5:(r=e.sent).error&&h(r.error);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"auth"},a.a.createElement("input",{type:"text",onChange:function(e){i(e.target.value)}}),a.a.createElement("button",{onClick:b},"Login"),a.a.createElement("a",{href:"/register"}," or Register"),f&&a.a.createElement("div",{style:{color:"red"}},f))})),J=d((function(e){var t=e.children,n=e.appContainer,r=e.path;return n.getUserRepository().isLoggedIn?a.a.createElement(f.b,{path:r,component:function(){return t}}):a.a.createElement(f.a,{to:"/login"})})),W=d((function(e){var t=e.appContainer,n=Object(r.useState)(null),c=Object(u.a)(n,2),s=c[0],i=c[1];return Object(r.useEffect)((function(){var e=t.getStatsRepository();Promise.resolve().then(Object(m.a)(p.a.mark((function n(){var r,a;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.get();case 2:r=n.sent,a=r.data.find((function(e){return e.username===t.getUserRepository().get().username})),i(a);case 5:case"end":return n.stop()}}),n)}))))}),[t]),a.a.createElement("div",{style:{margin:"0 auto",width:800}},s&&a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,s.username),s.stats.map((function(e,t){return a.a.createElement("div",{key:t,style:{marginBottom:8}},e.map((function(t,n){return a.a.createElement("div",{key:t},n===e.length-1?new Date(t).toString():t)})))}))))})),D=d((function(e){var t=e.children,n=e.appContainer,r=e.path;return n.getUserRepository().isLoggedIn?a.a.createElement(f.a,{to:"/board"}):a.a.createElement(f.b,{path:r,component:function(){return t}})})),Y=new URL(window.location).searchParams.get("time"),z=Y||18e4;var $=function(){var e=new S(o.a),t=new U(o.a),n=new M(o.a,t),c=new R(e,new F,[new I,new L],n,t,z),s=Object(r.useState)(t.isLoggedIn),i=Object(u.a)(s,2)[1];return Object(r.useEffect)((function(){t.subscribe("loginChange",(function(e){i(e)}))}),[t]),a.a.createElement(l.a,null,a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},"Type Racer"),a.a.createElement("nav",null,a.a.createElement("ul",null,t.isLoggedIn?a.a.createElement(a.a.Fragment,null,a.a.createElement("li",null,a.a.createElement(l.b,{to:"/board"},"Board")),a.a.createElement("li",null,a.a.createElement(l.b,{to:"/stats"},"Stats")),a.a.createElement("li",{onClick:function(){t.logout()}},"Logout")):a.a.createElement(a.a.Fragment,null,a.a.createElement("li",null,a.a.createElement(l.b,{to:"/login"},"Login")),a.a.createElement("li",null,a.a.createElement(l.b,{to:"/register"},"Register"))))),a.a.createElement(v.Provider,{value:{appContainer:c}},a.a.createElement(f.d,null,a.a.createElement(J,{path:"/board"},a.a.createElement(x,null)),a.a.createElement(J,{path:"/stats"},a.a.createElement(W,null)),a.a.createElement(D,{path:"/register"},a.a.createElement(A,null)),a.a.createElement(D,{path:"/login"},a.a.createElement(B,null)),a.a.createElement(f.a,{to:"/board"})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.19b534ae.chunk.js.map